---
title: "Your Title"
output:
  github_document:
    toc: true
    toc_depth: 2
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


# Example
```{r, eval=FALSE}
library(drc)
library(tidyr)
library(dplyr)

# Example dataset
data(metallo)


# Fit a probit model
model <- drm(dead/total ~ conc, weights = total, data = metallo,
             fct = LN.2(), type = "binomial")
summary(model)
ED(model, c(50, 90), interval = "delta")  # LC50, LC90, and 95% CIs

```

# Green, Oct 23rd, at 24 hours

```{r}
library(drc)
library(tidyr)
library(dplyr)

# 1. Create dataframe
bioassay <- data.frame(
  conc = c(0, 0.00025, 0.001, 0.0025, 0.01),  # concentrations (ppm)
  dead1 = c(1, 3, 2, 7, 2),
  dead2 = c(0, 3, 2, 0, 9),
  dead3 = c(6, 5, 7, 4, 10),
  total = 25
)

# Convert to long format (one row per replicate)
bioassay_long <- data.frame(
  conc  = rep(bioassay$conc, each = 3),
  dead  = c(bioassay$dead1, bioassay$dead2, bioassay$dead3),
  total = rep(bioassay$total, each = 3)
)

bioassay_long

# 2. fit the probit model

model <- drm(dead/total ~ conc, 
             weights = total, 
             data = bioassay_long,
             fct = LN.2(),   # log-normal 2-parameter model
             type = "binomial")

summary(model)

# 3. Estimate LC50 and LC90
ED(model, c(50, 90), interval = "delta")


# 4. Plot the concentration–response curve
plot(model, log = "x",
     xlab = "Concentration (ppm)",
     ylab = "Proportion mortality",
     main = "Concentration–Response Curve")
```

Interpretation of these results:
the slope parameter (b) is highly significant (p < 0.001),

but the LC₅₀ parameter (e) is not statistically significant (p = 0.29).

Let’s unpack that precisely:

1. Understanding the parameters
Parameter	Meaning	Estimate	Interpretation
b:(Intercept)	slope of the probit/log-normal curve	0.226 ± 0.054	Significant (p < 0.001) → there is a measurable change in mortality with concentration. The positive slope indicates increasing mortality with dose.
e:(Intercept)	log₁₀(LC₅₀)	0.099 ± 0.094	Not significant (p = 0.29). This means the estimated LC₅₀ (≈ 10^0.099 ≈ 1.26 ppm) is imprecise—its confidence interval still overlaps very low values.

# Green, Oct 8, 24 hours
```{r, eval=FALSE}
# 1. Create dataframe
bioassay <- data.frame(
  conc = c(0, 0.0025, 0.025),  # concentrations (ppm)
  dead1 = c(25-24, 25-3, 25-9),
  dead2 = c(25-24, 25-3, 25-4),
  dead3 = c(25-23, 25-3, 25-5),
  total = 25
)

# Convert to long format (one row per replicate)
bioassay_long <- data.frame(
  conc  = rep(bioassay$conc, each = 3),
  dead  = c(bioassay$dead1, bioassay$dead2, bioassay$dead3),
  total = rep(bioassay$total, each = 3)
)

bioassay_long

# 2. fit the probit model
model <- drm(dead/total ~ conc, 
             weights = total, 
             data = bioassay_long,
             fct = LN.2(),   # log-normal 2-parameter model
             type = "binomial")

summary(model)

# 3. Estimate LC50 and LC90
ED(model, c(50, 90), interval = "delta")

# 4. Plot the concentration–response curve
plot(model, log = "x",
     xlab = "Concentration (ppm)",
     ylab = "Proportion mortality",
     main = "Concentration–Response Curve")
```

# Green, Dec 3rd, at 36 hours

```{r}
library(drc)
library(tidyr)
library(dplyr)

# 1. Create dataframe
bioassay <- data.frame(
  conc = c(0.0005, 0.005, 0.05, 0.5, 5, 50, 500),  # concentrations (ppm)
  dead1 = c(1,2,1,14,13,15,20),
  dead2 = c(1,1,2,11,16,16,25),
  total = 25
)

# Convert to long format (one row per replicate)
bioassay_long <- bioassay %>%
  pivot_longer(cols = c(dead1, dead2),
               names_to = "replicate",
               values_to = "dead") %>%
  mutate(total = total)  # total is the same for both rows

bioassay_long

# 2. fit the probit model
model <- drm(dead/total ~ conc, 
             weights = total, 
             data = bioassay_long,
             fct  = LN.2(),     # log-normal 2-parameter model
             type = "binomial")

summary(model)

ED(model, c(50, 90), interval = "delta")

plot(model, log = "x",
     xlab = "Concentration (ppm)",
     ylab = "Proportion mortality",
     main = "Concentration–Response Curve")
```